{% extends "base.html" %}
{% block body %}
<div class="container mt-4 mb-5">
  <h2 class="mb-3">WordWhiz - {{ category }}</h2>
  {% if error %}
    <div class="alert alert-warning">{{ error }}</div>
  {% else %}
    <div class="mb-2 fw-bold">Question {{ current }} of {{ total }}</div>
    <form method="post" id="wordwhiz_form">
      {% csrf_token %}
      <h4>{{ question.question_text }}</h4>
      <div class="mt-3">
        {% for choice in choices %}
          <div class="form-check mb-2">
            <input class="form-check-input" type="radio" name="selected_answer" id="choice{{ forloop.counter }}" value="{{ choice }}" required>
            <label class="form-check-label" for="choice{{ forloop.counter }}">{{ choice }}</label>
          </div>
        {% endfor %}
      </div>
      <button type="submit" class="btn btn-success mt-3">Submit</button>
      <div class="mt-3 text-muted"><b>Time left:</b> <span id="timer">{{ time_limit }}</span> seconds</div>
    </form>
  {% endif %}
</div>

<script>
  // Simple countdown timer
  let time = {{ time_limit }};
  const timerElem = document.getElementById('timer');
  const form = document.getElementById('wordwhiz_form');

  let interval = setInterval(() => {
    if (time <= 0) {
      clearInterval(interval);
      alert("Time's up! Submitting answer...");
      form.submit();
    } else {
      time--;
      timerElem.textContent = time;
    }
  }, 1000);
</script>

{% endblock %}
